diff -ruN orig/CMakeLists.txt asm/CMakeLists.txt
--- orig/CMakeLists.txt	2024-02-01 21:52:43.734332000 +0100
+++ asm/CMakeLists.txt	2024-02-01 21:53:29.706590000 +0100
@@ -24,6 +24,8 @@
 		processor.F90 parallel_processor.F90 pme_fft_midpoint.F90 pme_recip_midpoint.F90
         dihedrals_midpoint.F90 angles_midpoint.F90 bonds_midpoint.F90 runreweight.F90
         dbg_arrays.F90 mcres.F90 ensure_alloc.F90 reservoir.F90 sams.F90 ramd.F90
+        CV_module.F90 multiCV_module.F90 splines_utilities.F90 
+        string_utilities.F90 CV_utilities.F90 string_method.F90
         gti.F90 reaf.F90 
         xray_globals.F90
         xray_interface.F90
diff -ruN orig/Makefile asm/Makefile
--- orig/Makefile	2024-02-01 21:58:18.274719000 +0100
+++ asm/Makefile	2024-02-01 21:53:29.726600000 +0100
@@ -59,6 +59,7 @@
         gti$(OSFX) reaf$(OSFX) \
         processor$(OSFX) parallel_processor$(OSFX) pme_fft_midpoint$(OSFX) pme_recip_midpoint$(OSFX) \
         dihedrals_midpoint$(OSFX) angles_midpoint$(OSFX) bonds_midpoint$(OSFX) dbg_arrays$(OSFX) mcres$(OSFX) \
+		CV_module$(OSFX) multiCV_module$(OSFX) splines_utilities$(OSFX) string_utilities$(OSFX) CV_utilities$(OSFX) string_method$(OSFX) \
         ensure_alloc$(OSFX) reservoir${OSFX} sams${OSFX} ramd${OSFX} runreweight${OSFX} hybridsolvent_remd$(OSFX) \
 		md_scheme$(OSFX)
 
@@ -238,3 +239,4 @@
 ## Dependencies for f90 modules and include files generated by makef90depends:
 
 include f90depends
+# DO NOT DELETE
diff -ruN orig/runmd.F90 asm/runmd.F90
--- orig/runmd.F90	2024-02-01 21:53:15.901010000 +0100
+++ asm/runmd.F90	2024-02-01 21:53:29.727849000 +0100
@@ -123,6 +123,12 @@
   use dbg_arrays_mod
 #endif
 
+! ASM
+#ifdef MPI
+  use string_method_mod, only : string_define, string_defined, string_calc
+#endif
+! END_ASM
+
 ! Modified by zhf
   use md_scheme
 !---------------------------------------------------------------
@@ -308,6 +314,10 @@
 #endif
 #endif
 
+! ASM
+  double precision      :: string_e, string_frc(3,atm_cnt)
+! END_ASM
+
   !SGLD
   double precision      :: sgsta_rndfp, sgend_rndfp, ignore_solvent
 
@@ -579,6 +589,12 @@
 #   include "Plumed_init.inc"
   endif
 
+! ASM
+#ifdef MPI
+  call string_define(crd)
+#endif
+! END_ASM
+
 ! Make a first dynamics step:
 
   irespa = 1    ! PME respa step counter.
@@ -787,6 +803,22 @@
 #endif
     end if
 
+! ASM
+#ifdef MPI
+    if (string_defined) then
+#ifdef CUDA
+      call gpu_download_crd(crd)
+#endif
+      call string_calc(crd, string_frc, string_e)
+#ifdef CUDA
+      call gpu_upload_frc_add(string_frc)
+#else
+      frc = frc + string_frc
+#endif
+    end if
+#endif
+! END_ASM
+
     irespa = 1
 
     ! The coordinates will not be changed between here and the next
@@ -1822,6 +1854,22 @@
 #endif
       end if
 
+! ASM
+#ifdef MPI
+    if (string_defined) then
+#ifdef CUDA
+      call gpu_download_crd(crd)
+#endif
+      call string_calc(crd, string_frc, string_e)
+#ifdef CUDA
+      call gpu_upload_frc_add(string_frc)
+#else
+      frc = frc + string_frc
+#endif
+    end if
+#endif
+! END_ASM
+
       ! Pressure coupling:
 
       if (ntp .gt. 0) then
